KISSY.Editor.add("htmlparser-element",function(){function m(d,a){this.name=d;this.attributes=a||(a={});this.children=[];var c=a._ke_real_element_type||d;a=f.XHTML_DTD;c=!!(a.$nonBodyContent[c]||a.$block[c]||a.$listItem[c]||a.$tableContent[c]||a.$nonEditable[c]||c=="br");var b=!!a.$empty[d];this.isEmpty=b;this.isUnknown=!a[d];this._={isBlockLike:c,hasInlineStarted:b||!c}}var f=KISSY.Editor;if(!f.HtmlParser.Element){var n=f.NODE,p=function(d,a){d=d[0];a=a[0];return d<a?-1:d>a?1:0};KISSY.augment(m,{type:n.NODE_ELEMENT,
add:f.HtmlParser.Fragment.prototype.add,clone:function(){return new m(this.name,this.attributes)},writeHtml:function(d,a){var c=this.attributes,b=this,g=b.name,e,h,j,k;b.filterChildren=function(){if(!k){var o=new f.HtmlParser.BasicWriter;f.HtmlParser.Fragment.prototype.writeChildrenHtml.call(b,o,a);b.children=(new f.HtmlParser.Fragment.fromHtml(o.getHtml())).children;k=1}};if(a){for(;;){if(!(g=a.onElementName(g)))return;b.name=g;if(!(b=a.onElement(b)))return;b.parent=this.parent;if(b.name==g)break;
if(b.type!=n.NODE_ELEMENT){b.writeHtml(d,a);return}g=b.name;if(!g){this.writeChildrenHtml.call(b,d,k?null:a);return}}c=b.attributes}d.openTag(g,c);for(var l=[],i=0;i<2;i++)for(e in c){h=e;j=c[e];if(i==1)l.push([e,j]);else if(a){for(;;)if(h=a.onAttributeName(e))if(h!=e){delete c[e];e=h}else break;else{delete c[e];break}if(h)if((j=a.onAttribute(b,h,j))===false)delete c[h];else c[h]=j}}d.sortAttributes&&l.sort(p);c=l.length;for(i=0;i<c;i++){e=l[i];d.attribute(e[0],e[1])}d.openTagClose(g,b.isEmpty);if(!b.isEmpty){this.writeChildrenHtml.call(b,
d,k?null:a);d.closeTag(g)}},writeChildrenHtml:function(){f.HtmlParser.Fragment.prototype.writeChildrenHtml.apply(this,arguments)}});f.HtmlParser.Element=m}});
