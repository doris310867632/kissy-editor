KISSY.Editor.add("htmldataprocessor",function(){function h(a){a=a.replace(/mso-[^;]+(;|$)/ig,"").replace(/line-height[^;]+(;|$)/ig,"").replace(/font-size[^;]+pt(;|$)/ig,"").replace(/font-family[^;]+(;|$)/ig,"").replace(/display\s*:\s*none\s*(;|$)/ig,"");return i.trim(a)}var e=KISSY.Editor;if(!e.HtmlDataProcessor){var i=KISSY,k=i.UA,d=e.HtmlParser,f=new d.Filter,g=new d.Filter,l={elementNames:[[/^script$/i,""],[/^iframe$/i,""],[/^style$/i,""],[/^link$/i,""],[/^meta$/i,""],[/^\?xml.*$/i,""],[/^.*namespace.*$/i,
""]],elements:{font:function(a){delete a.name},$:function(a){(a.name||"").indexOf(":")!=-1&&delete a.name},table:function(a){var b=a.attributes.border;if(!b||b=="0")a.attributes["class"]="ke_show_border"},span:function(a){var b=a.attributes.style;if(!b||!h(b)){a.filterChildren();delete a.name}}},attributes:{"class":function(a){if(/^ke_/.test(a))return a;return false},style:function(a){a=h(a);if(!a)return false;return a}},attributeNames:[[/^on/,"ck_on"],[/^lang$/,""]]},j={elementNames:[[/^ke:/,""],
[/^\?xml:namespace$/,""]],elements:{embed:function(a){var b=a.parent;if(b&&b.name=="object"){var c=b.attributes.width;b=b.attributes.height;c&&(a.attributes.width=c);b&&(a.attributes.height=b)}},param:function(a){a.children=[];a.isEmpty=true;return a},a:function(a){if(!(a.children.length||a.attributes.name))return false},span:function(a){if(!a.children.length)return false}},attributes:{},attributeNames:[[/^ck_on/,"on"]]};if(k.ie)j.attributes.style=function(a){return a.toLowerCase()};f.addRules(j);
g.addRules(l);e.HtmlDataProcessor={htmlFilter:f,dataFilter:g,toHtml:function(a,b){var c=new d.HtmlWriter;d.Fragment.FromHtml(a,b).writeHtml(c,f);return c.getHtml(true)},toDataFormat:function(a,b){var c=new d.HtmlWriter;a=d.Fragment.FromHtml(a,b);c.reset();a.writeHtml(c,g);return c.getHtml(true)}}}});
